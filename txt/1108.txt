The New York grand jury hearing the case against Donald Trump was set to break for several weeks. The former president's lawyers believed on Wednesday afternoon they had at least a small reprieve from a possible indictment. Trump praised the perceived delay. Manhattan District Attorney Alvin Bragg had other plans. Thursday afternoon, Bragg asked the grand jury to return an historic indictment against Trump, the first time that a current or former US president has been indicted. The surprise move was the final twist in an investigation that's taken a long and winding road to the history-making charges that were returned this week. An indictment had been anticipated early last week -- including by Trump himself, who promoted a theory he would be "arrested" -- as law enforcement agencies prepared for the logistics of arraigning a former president. But after the testimony of Robert Costello -- a lawyer who appeared on Trump's behalf seeking to undercut the credibility of Trump's former attorney and fixer Michael Cohen -- Bragg appeared to hit the pause button. Costello's testimony caused the district attorney's office to reassess whether Costello should be the last witness the grand jury heard before prosecutors asked them to vote on an indictment, multiple sources told CNN. So they waited. The next day the grand jury was scheduled to meet, jurors were told not to come in. Bragg and his top prosecutors huddled the rest of the week and over the weekend to determine a strategy that would effectively counter Costello's testimony in the grand jury. They called two additional witnesses. David Pecker, the former head of the company that publishes the National Enquirer, appeared on Monday. The other witness, who has still not been identified, testified on Thursday for 35 minutes in front of the grand jury -- just before prosecutors asked them to vote on the indictment of more than 30 counts, the sources said. Trump and his attorneys, thinking Bragg might be reconsidering a potential indictment, were all caught off-guard, sources said. Some of Trump's advisers had even left Palm Beach on Wednesday following news reports that the grand jury was taking a break, the sources added. After the indictment, Trump ate dinner with his wife, Melania, Thursday evening and smiled while he greeted guests at his Mar-a-Lago club, according to a source familiar with the event. The Manhattan district attorney's investigation into Trump has been ongoing for years, dating back to Bragg's predecessor, Cy Vance. Its focus shifted by mid-2020 to the accuracy of the Trump Org.'s financial statements. At the time, prosecutors debated legal theories around the hush money payments and thought they were a long shot. At several points, the wide-ranging investigation seemed to have been winding down -- to the point that prosecutors resigned in protest last year. One even wrote a book critical of Bragg for not pursuing charges against Trump released just last month. The specific charges against Trump still remain under seal and are expected to be unveiled Tuesday when Trump is set to be arraigned. There are questions swirling even among Trump critics over whether the Manhattan district attorney's case is the strongest against the former president amid additional investigations in Washington, DC, and Georgia over both his efforts to overturn the 2020 election and his handling of classified documents at his Florida resort. Trump could still face charges in those probes, too, which are separate from the New York indictment. But it's the Manhattan indictment, dating back to a payment made before the 2016 presidential election, that now sees Trump facing down criminal charges for the first time as he runs again for the White House in 2024. A $130,000 hush money payment It was just weeks before the 2016 election when Cohen, Trump's then-lawyer, paid adult film actress Stormy Daniels $130,000 to keep silent about an alleged affair with Trump. (Trump has denied the affair.) Cohen was later reimbursed $420,000 by the Trump Organization to cover the original payment and tax liabilities and to reward him with a bonus. That payment and reimbursement are keys at issue in the investigation. Cohen also helped arrange a $150,000 payment from the publisher of the National Enquirer to Karen McDougal to kill her story claiming a 10-month affair with Trump. Trump also denies an affair with McDougal. During the grand jury proceedings, the district attorney's office has asked questions about the "catch and kill" deal with McDougal. When Cohen was charged by federal prosecutors in New York in 2018 and pleaded guilty, he said he was acting at the direction of Trump when he made the payment. At the time, federal prosecutors had determined they could not seek to indict Trump in the scheme because of US Justice Department regulations against charging a sitting president. In 2021, after Trump left the White House, prosecutors in the Southern District of New York decided not to pursue a case against Trump, according to a recent book from CNN senior legal analyst Elie Honig. But then-Manhattan District Attorney Vance's team had already picked up the investigation into the hush money payments and begun looking at potential state law violations. By summer 2019, they sent subpoenas to the Trump Org., other witnesses, and met with Cohen, who was serving a three-year prison sentence. Vance's investigation broadened to the Trump Org.'s finances. New York prosecutors went to the Supreme Court twice to enforce a subpoena for Trump's tax records from his long-time accounting firm Mazars USA. The Trump Org. and its long-time chief financial officer Allen Weisselberg were indicted on tax fraud and other charges in June 2021 for allegedly running an off-the-books compensation scheme for more than a decade. Weisselberg pleaded guilty to the charges last year and is currently serving a five-month sentence at Rikers Island. Prosecutors had hoped to flip Weisselberg to cooperate against Trump, but he would not tie Trump to any wrongdoing. Disagreements about the pace of the investigation had caused at least three career prosecutors to move off the investigation. They were concerned that the investigation was moving too quickly, without clear evidence to support possible charges, CNN and others reported last year. Vance authorized the attorneys on the team to present evidence to the grand jury near the end of 2021, but he did not seek an indictment. Those close to Vance say he wanted to leave the decision to Bragg, the newly elected district attorney. Resignations after Bragg took office Bragg, a Democrat, took office in January 2022. Less than two months into his tenure, two top prosecutors who had worked on the Trump case under Vance abruptly resigned amid a disagreement in the office over the strength of the case against Trump. On February 22, 2022, Bragg informed the prosecution team that he was not prepared to authorize charges against Trump, CNN reported. The prosecutors, Carey Dunne and Mark Pomerantz, resigned the next day. In his resignation letter, Pomerantz said he believed Trump was guilty of numerous felonies and said that Bragg's decision to not move forward with an indictment at the time was "wrong" and a "grave failure of justice." "I and others believe that your decision not to authorize prosecution now will doom any future prospects that Mr. Trump will be prosecuted for the criminal conduct we have been investigating," Pomerantz wrote in the letter, which was reviewed by CNN. At that point, the investigation was focused on Trump's financial statements and whether he knowingly misled lenders, insurers, and others by providing them false or misleading information about the value of his properties. Prosecutors were building a wide-ranging falsified business records case to include years of financial statements and the hush money payments, people with direct knowledge of the investigation told CNN. But at the time, those prosecutors believed there was a good chance a felony charge related to the hush money payment would be dismissed by a judge because it was a novel legal theory. Dunne and Pomerantz pushed to seek an indictment of Trump tied to the sweeping falsified business records case, but others, including some career prosecutors, were skeptical that they could win a conviction at trial, in part because of the difficulty in proving Trump's criminal intent. 'Following the leads in front of us' Despite the resignations of the prosecutors on the Trump case, Bragg's office reiterated at the time that the investigation was ongoing. "Investigations are not linear so we are following the leads in front of us. That's what we're doing," Bragg told CNN in April 2022. "The investigation is very much ongoing." At the same time that Bragg's criminal investigation into Trump lingered last year, another prosecution against the Trump Org. moved forward. In December, two Trump Org. entities were convicted at trial on 17 counts and were ordered to pay $1.6 million, the maximum penalty, the following month. Trump was not personally charged in that case. But it appeared to embolden Bragg's team to sharpen their focus back to Trump and the hush money payment. Cohen was brought back in to meet with Manhattan prosecutors. Cohen had previously met with prosecutors in the district attorney's office 13 times over the course of the investigation. But the January meeting was the first in more than a year -- and a clear sign of the direction prosecutors were taking. As investigators inched closer to a charging decision, Bragg was faced with more public pressure to indict Trump: Pomerantz, the prosecutor who had resigned a year prior, released a book about the investigation that argued Trump should be charged and criticized Bragg for failing to do so. "Every single member of the prosecution team thought that his guilt was established," Pomerantz said in a February interview on "CNN This Morning." Asked about Bragg's hesitance, Pomerantz said: "I can't speak in detail about what went through his mind. I can surmise from what happened at the time and statements that he's made since that he had misgivings about the strength of the case." Bragg responded in a statement saying that more work was needed on the case. "Mr. Pomerantz's plane wasn't ready for takeoff," Bragg said. Prosecutors continued bringing in witnesses, including Pecker, the former head of American Media Inc., which publishes the National Enquirer. In February, Trump Org. controller Jeffrey McConney testified before the grand jury. Members of Trump's 2016 campaign, including Kellyanne Conway and Hope Hicks, also appeared. In March, Daniels met with prosecutors, her attorney said. And Cohen, after his numerous meetings with prosecutors, finally testified before the grand jury in March. A fina